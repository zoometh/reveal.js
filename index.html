<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Web3D - multiscalar</title>
		<meta name="description" content="Integration of multiscalar 3D model for use-wear analysis">
		<meta name="author" content="Thomas Huet">

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/custom.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">
	</head>
	<body>
		<div class="reveal">
			<!-- header top position -->
			<header style="position: absolute; top: 50px; left: 100px; z-index:500; font-size:1.6em"></header>
			<div class="slides">

				<section>
					<a href="https://github.com/zoometh/rockart">
						<img src="https://raw.githubusercontent.com/zoometh/thomashuet/main/img/prj_rockart_1.png" alt="" style="height: 180px; margin: 0 auto 4rem auto; background: transparent;" class="demo-logo">
					</a>
					<h3>Web3D and multiscalar integration of 3D models</h3>
					<small><em>9th Seminar of Prehistoric Technology at the IMF-CSIC, Barcelona, 2-4 May 2022</em></small>
					<p>
						<smaller>
							<!-- <div> -->
								<span style="">
								<a href="https://github.com/zoometh/thomashuet#dr-thomas-huet-">Thomas Huet</a><br>
								<small>University of Oxford</small><br>
							 	<a href="https://www.arch.ox.ac.uk/people/dr-thomas-huet"> 
								<img src="https://raw.githubusercontent.com/zoometh/thomashuet/main/img/inst-uni-oxford.png" alt="" style="height: 80px; margin: 0 auto 4rem auto; background: transparent; vertical-align: middle;" class="demo-logo">
								</a>
								</span>
							<!-- </div> -->
							</smaller>
					</p>
				</section>

				<section>

					<section data-background-image="https://raw.githubusercontent.com/zoometh/rockart/main/www/mont_lassois.png">
						<h2>Introduction</h2>
						Human actions create marks on natural backgrounds
						<img src="https://raw.githubusercontent.com/zoometh/rockart/main/www/mont_lassois.png" alt="" style="height: 380px; margin: 0 auto 4rem auto; background: transparent;" class="demo-logo">
					</section>
					<section>
						<h2>At the &mu;m scale</h2>
						<a href="https://www.sensofar.com/cs17_prehistoric-tool-use-and-the-evolution-of-landscapes-a-3d-microwear-perspective">
							<img src="https://cdn-codno.nitrocdn.com/cvzuyGhVgHRiUuxfkFjAjSveRtjVlltF/assets/static/optimized/rev-000c82d/wp-content/uploads/2021/03/cs17-IMF-CSIC-prehistoric-tool-5.jpg" alt="" style="height: 380px; margin: 0 auto 4rem auto; background: transparent;" class="demo-logo">
						</a>
						<span class="caption">J.J. Iba√±ez</span>
					</section>
					<section>
						<h2>At the cm scale</h2>
						<a href="https://tel.archives-ouvertes.fr/tel-00712290">
							<img src="https://raw.githubusercontent.com/zoometh/rockart/main/www/19_4_21alpha_NB.jpg" alt="" style="height: 380px; margin: 0 auto 4rem auto; background: transparent;" class="demo-logo">
						</a>
						<span class="caption">N. Bianchi</span>
					</section>
					<section>
						<h2>At the metric scale</h2>
						<a href="https://github.com/zoometh/popland">
							<img src="https://raw.githubusercontent.com/zoometh/popland/main/doc/data/sidbury/sidbury_rayshader.png" alt="" style="height: 380px; margin: 0 auto 4rem auto; background: transparent;" class="demo-logo">
						</a>
						<span class="caption">T. Huet</span>
					</section>
				</section>

				<section>
					<h3>All these examples are instrumental practices that inform us on cultural choices</h3>
					<p>Link the <u>&mu;m scale</u> of use-wear üî¨, with the <u>cm scale</u> of a tool üî® or a rock panel üóø, ..., and all these objects with their current locations üåé.</p>
					<!-- <aside class="notes">
						Shhh, these are your private notes üìù
					</aside> -->
				</section>

				<section>
					<section data-state="header1" data-background-iframe="https://zoometh.github.io/3DHOP/minimal/lithic_tool.html" data-background-interactive>
						<style>.header1 header:after { content: "Web3D"; }</style>
					</section>
					<section data-state="header1" data-background-iframe="https://zoometh.github.io/Rdev/3d/standard_stack.html" data-background-interactive>
						<style>.header1 header:after { content: "Web3D"; }</style>
					</section>

				</section>

				<section>

					<section>
					<a href="https://www.r-project.org/">
						<img src="https://www.r-project.org/logo/Rlogo.svg" alt="" style="height: 100px; margin: 0 auto 4rem auto; background: transparent;" class="demo-logo">
					</a>
					ConFocal <code>.dat</code> ‚û°Ô∏è <code>.xyz</code>
					<pre><code data-trim data-noescape data-line-numbers="3-4|5-6|7|8-9">
						# clean a .dat file coming from the Confocal
						# and export it to .xyz
						file.name <- "confoc_3d.dat"
						file.path <- "c:/Rprojects/rockart/www/"
						file.data <- read.table(paste0(file.path, file.name),
												header = FALSE, sep = "")
						file.data <- file.data[, c(1, 2, 3)]
						write.table(file.data, paste0(file.path, "confoc_3d.xyz"),
									sep = " ", row.names = FALSE, col.names = FALSE)
					</code></pre>
					<p style="text-align: right;">
						<a href="https://github.com/zoometh/rockart/blob/main/functions/clean_dat.R"><code>clean_dat.R</code></a>
					</p>
					</section>

					<section>
					<a href="https://www.r-project.org/">
						<img src="https://www.r-project.org/logo/Rlogo.svg" alt="" style="height: 100px; margin: 0 auto 4rem auto; background: transparent;" class="demo-logo">
					</a>
					File <code>.xyz</code>
					<pre><code data-trim data-noescape data-line-numbers="1-10">
						1163.800903	1884.78186	-134.619141
						1163.800903	1895.481812	-135.691895
						1154.042236	1895.481812	-134.619141
						25.862251	1828.182739	-134.619141
						25.862251	1829.831421 -134.89502
						24.993202	1829.831421 -134.619141
						1174.742554	1889.450562	-134.619141
						1174.742554 1895.481812 -135.005859
						47.745689	1816.550171 -134.619141
						47.745689	1818.889771 -135.354126
						37.796516	1818.889771 -134.619141
						1177.233032 1895.481812 -134.619141
						1163.800903 1903.756226 -134.619141
						36.803978	1829.831421 -136.988892
						36.803978	1819.161255 -134.619141
						1174.742554	1901.637085 -134.619141
						47.745689 	1829.831421 -136.557495
					</code></pre>
					</section>

					<section>
						<a href="https://www.r-project.org/">
							<img src="https://www.r-project.org/logo/Rlogo.svg" alt="" style="height: 100px; margin: 0 auto 4rem auto; background: transparent;" class="demo-logo">
						</a>
						3D analysis with with the package <a href="https://github.com/bioXgeo/geodiv#readme">geodiv</a>
						<pre><code data-trim data-noescape data-line-numbers="1-3|5|7-10|12-14|15-16">
							library(geodiv)
							library(knitr)
							library(kableExtra)
							
							xyz.mat <- as.matrix(xyz)
							
							sq.var <- sq(xyz.mat)
							sa.var <- sa(xyz.mat)
							sku.var <- sku(xyz.mat)
							ssk.var <- ssk(xyz.mat)
							
							df.var <- data.frame(abbrev = c('Sq', 'Sa', 'Sku', 'Ssk', '...'),
												 descr = c('Root mean square height', 'Average roughness', 'Kurtosis', 'Skewness', '...'),
												 val = c(sq.var, sa.var, sku.var, ssk.var, '...'))
							kable(df.var,"html") %>% 
							  kable_styling(full_width = FALSE, position = "center", font_size = 12)
						</code></pre>
						<p style="text-align: right;">
							<a href="https://github.com/zoometh/rockart/blob/main/functions/geodiv_surface_analyse.R"><code>geodiv_surface_analyse.R</code></a>
						</p>
					</section>
				  
					<section>
					<a href="https://www.r-project.org/">
						<img src="https://www.r-project.org/logo/Rlogo.svg" alt="" style="height: 100px; margin: 0 auto 4rem auto; background: transparent;" class="demo-logo">
					</a>
					3D interactive plotting with the package <a href="https://plotly.com/r/3d-scatter-plots/">plot_ly</a>
					<pre><code data-trim data-noescape data-line-numbers="1|3-4|6-14|17-23|26-39|42|44-45|47-48">
						library(plotly)
						library(dplyr)
						library(htmlwidgets)

						url.www <- "https://raw.githubusercontent.com/zoometh/rockart/main/www/"
						xyz <- read.csv(paste0(url.www, "/confoc_3d.xyz"), sep = " ", header = F)

						axx <- list(
						title = "X \u03BCm"
						)
						axy <- list(
						title = "Y \u03BCm"
						)
						axz <- list(
						title = "Z \u03BCm"
						)

						## surface
						surf3d <- plot_ly(x = xyz$V1, y = xyz$V2, z = xyz$V3,
								intensity = xyz$V3, type = 'mesh3d',
								colorbar = list(title = "Z \u03BCm"))  %>%
						layout(title = "ConFocal surface",
								scene = list(xaxis = axx, yaxis = axy, zaxis = axz,
											aspectmode = 'data'))
						surf3d

						## surface with a user-drawn marker
						surf3d_mark <- plot_ly()%>%
						add_trace(type = "scatter3d", mode="markers", 
									x = 1282.68, y = 1246.93, z = -9.86,
									marker = list(size = 10,
												color = '#FF0000',
												opacity = .3)
									) %>%
						add_trace(x = xyz$V1, y = xyz$V2, z = xyz$V3,
									intensity = xyz$V3, type = 'mesh3d',
									colorbar = list(title = "Z \u03BCm")) %>%
						layout(title = "ConFocal surface",
								scene = list(xaxis = axx, yaxis = axy, zaxis = axz,
											aspectmode = 'data'))
						surf3d_mark

						## surface with calculated markers
						z.max <- xyz[xyz$V3 == max(xyz$V3), ] 
						z.min <- xyz[xyz$V3 == min(xyz$V3), ]
						z.intervals <- rbind(z.max, z.min)
						surf3d_marks <- plot_ly()%>%
						add_trace(type = "scatter3d", mode="markers", 
									x = c(z.intervals$V1), y = c(z.intervals$V2), z = c(z.intervals$V3),
									marker = list(size = 5,
												color = c('#0000FF', '#00FF00'))
						) %>%
						add_trace(x = xyz$V1, y = xyz$V2, z = xyz$V3,
									intensity = xyz$V3, type = 'mesh3d',
									colorbar = list(title = "Z \u03BCm")) %>%
						layout(title = "ConFocal surface",
								scene = list(xaxis = axx, yaxis = axy, zaxis = axz,
											aspectmode = 'data'))
						surf3d_marks


						## export in HTML
						library(htmlwidgets)

						saveWidget(as_widget(surf3d), "surf3d.html")
						# creates https://zoometh.github.io/rockart/surf3d

						saveWidget(as_widget(surf3d_mark), "surf3d_mark.html")
						# creates https://zoometh.github.io/rockart/surf3d_mark

						saveWidget(as_widget(surf3d_marks), "surf3d_marks.html")
						# creates https://zoometh.github.io/rockart/surf3d_marks

					</code></pre>
					<p style="text-align: right;">
						<a href="https://github.com/zoometh/rockart/blob/main/functions/plotly_surface_3d.R"><code>plotly_surface_3d.R</code></a>
					</p>
					</section>

					<section>
						<a href="https://www.r-project.org/">
							<img src="https://www.r-project.org/logo/Rlogo.svg" alt="" style="height: 100px; margin: 0 auto 4rem auto; background: transparent;" class="demo-logo">
						</a>
						Embed a 3D surface in a <code>iframe</code>
						<iframe data-src="https://zoometh.github.io/rockart/surf3d_marks" 
						width="700" height="400" frameborder="0" marginwidth="0" marginheight="0" 
						scrolling="no" style="border:3px solid #666; margin-bottom:5px; max-width:
						100%;" allowfullscreen=""></iframe>
						<p style="text-align: right;">
							<a href="https://zoometh.github.io/rockart/surf3d_marks"><code>surf3d_marks.html</code></a>
						</p>
						</section>
				</section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,
				slideNumber: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
		</script>
	</body>
</html>
